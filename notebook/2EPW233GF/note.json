{
  "paragraphs": [
    {
      "title": "Setting up the environment",
      "text": "%spark\nimport spark.implicits._\nimport org.apache.spark.sql._\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types._\n\nval wineReviewsJson \u003d spark.read.json(\"/svccdata/winereviews.json\")\n",
      "user": "anonymous",
      "dateUpdated": "2019-10-19 01:12:33.164",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/scala",
        "title": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "import spark.implicits._\nimport org.apache.spark.sql._\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types._\nwineReviewsJson: org.apache.spark.sql.DataFrame \u003d [country: string, description: string ... 11 more fields]\n"
          }
        ]
      },
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            "http://2cd1b9b392ef:4040/jobs/job?id\u003d64"
          ],
          "interpreterSettingId": "spark"
        }
      },
      "apps": [],
      "jobName": "paragraph_1571085249276_1024938294",
      "id": "20191014-203409_1763711758",
      "dateCreated": "2019-10-14 20:34:09.276",
      "dateStarted": "2019-10-19 01:12:33.228",
      "dateFinished": "2019-10-19 01:12:45.606",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "title": "Exploring the Inferred Schema",
      "text": "%spark\nval dataStructure \u003d wineReviewsJson.schema\nwineReviewsJson.printSchema",
      "user": "anonymous",
      "dateUpdated": "2019-10-19 01:12:45.648",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/scala",
        "title": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "root\n |-- country: string (nullable \u003d true)\n |-- description: string (nullable \u003d true)\n |-- designation: string (nullable \u003d true)\n |-- points: string (nullable \u003d true)\n |-- price: long (nullable \u003d true)\n |-- province: string (nullable \u003d true)\n |-- region_1: string (nullable \u003d true)\n |-- region_2: string (nullable \u003d true)\n |-- taster_name: string (nullable \u003d true)\n |-- taster_twitter_handle: string (nullable \u003d true)\n |-- title: string (nullable \u003d true)\n |-- variety: string (nullable \u003d true)\n |-- winery: string (nullable \u003d true)\n\ndataStructure: org.apache.spark.sql.types.StructType \u003d StructType(StructField(country,StringType,true), StructField(description,StringType,true), StructField(designation,StringType,true), StructField(points,StringType,true), StructField(price,LongType,true), StructField(province,StringType,true), StructField(region_1,StringType,true), StructField(region_2,StringType,true), StructField(taster_name,StringType,true), StructField(taster_twitter_handle,StringType,true), StructField(title,StringType,true), StructField(variety,StringType,true), StructField(winery,StringType,true))\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1571085268128_444892539",
      "id": "20191014-203428_1482484864",
      "dateCreated": "2019-10-14 20:34:28.128",
      "dateStarted": "2019-10-19 01:12:45.732",
      "dateFinished": "2019-10-19 01:12:46.294",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "title": "The DataFrame schema is your Friend",
      "text": "%spark\n/* schema.toDDL is spark-2.4.x feature - SEE Optional: Enhancing your Zeppelin Experience (Bring new Spark version) in the README */\nwineReviewsJson.schema.toDDL",
      "user": "anonymous",
      "dateUpdated": "2019-10-19 01:12:46.350",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/scala",
        "title": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "res42: String \u003d `country` STRING,`description` STRING,`designation` STRING,`points` STRING,`price` BIGINT,`province` STRING,`region_1` STRING,`region_2` STRING,`taster_name` STRING,`taster_twitter_handle` STRING,`title` STRING,`variety` STRING,`winery` STRING\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1571407816699_-1373314028",
      "id": "20191018-141016_1106158775",
      "dateCreated": "2019-10-18 14:10:16.699",
      "dateStarted": "2019-10-19 01:12:46.546",
      "dateFinished": "2019-10-19 01:12:46.930",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "title": "Use implicit schema to define complex StructType easily",
      "text": "%spark\nval structFromDDL \u003d StructType.fromDDL(wineReviewsJson.schema.toDDL)",
      "user": "anonymous",
      "dateUpdated": "2019-10-19 01:12:46.950",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/scala",
        "title": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "structFromDDL: org.apache.spark.sql.types.StructType \u003d StructType(StructField(country,StringType,true), StructField(description,StringType,true), StructField(designation,StringType,true), StructField(points,StringType,true), StructField(price,LongType,true), StructField(province,StringType,true), StructField(region_1,StringType,true), StructField(region_2,StringType,true), StructField(taster_name,StringType,true), StructField(taster_twitter_handle,StringType,true), StructField(title,StringType,true), StructField(variety,StringType,true), StructField(winery,StringType,true))\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1571407838467_1333526399",
      "id": "20191018-141038_1181959740",
      "dateCreated": "2019-10-18 14:10:38.467",
      "dateStarted": "2019-10-19 01:12:47.066",
      "dateFinished": "2019-10-19 01:12:47.508",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "title": "Skipping Schema Inference. Good for Life",
      "text": "%spark\nval wineReviewsJsonNotInferred \u003d spark.read.option(\"inferSchema\", \"false\").schema(structFromDDL).json(\"/svccdata/winereviews.json\")",
      "user": "anonymous",
      "dateUpdated": "2019-10-19 01:12:47.568",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/scala",
        "title": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "wineReviewsJsonNotInferred: org.apache.spark.sql.DataFrame \u003d [country: string, description: string ... 11 more fields]\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1571411994516_136157690",
      "id": "20191018-151954_1050495261",
      "dateCreated": "2019-10-18 15:19:54.516",
      "dateStarted": "2019-10-19 01:12:47.707",
      "dateFinished": "2019-10-19 01:12:48.102",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "title": "Create a Temp SQL View",
      "text": "%spark\nwineReviewsJsonNotInferred.createOrReplaceTempView(\"winereviews\")",
      "user": "anonymous",
      "dateUpdated": "2019-10-19 01:12:48.107",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/scala",
        "title": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": []
      },
      "apps": [],
      "jobName": "paragraph_1571412343583_-689196167",
      "id": "20191018-152543_1943150697",
      "dateCreated": "2019-10-18 15:25:43.583",
      "dateStarted": "2019-10-19 01:12:48.242",
      "dateFinished": "2019-10-19 01:12:48.642",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "title": "Look at the SQL Schema",
      "text": "%sql\ndesc winereviews",
      "user": "anonymous",
      "dateUpdated": "2019-10-19 01:12:48.729",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {
          "0": {
            "graph": {
              "mode": "table",
              "height": 300.0,
              "optionOpen": false,
              "setting": {
                "table": {
                  "tableGridState": {},
                  "tableColumnTypeState": {
                    "names": {
                      "col_name": "string",
                      "data_type": "string",
                      "comment": "string"
                    },
                    "updated": false
                  },
                  "tableOptionSpecHash": "[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]",
                  "tableOptionValue": {
                    "useFilter": false,
                    "showPagination": false,
                    "showAggregationFooter": false
                  },
                  "updated": false,
                  "initialized": false
                }
              },
              "commonSetting": {}
            }
          }
        },
        "editorSetting": {
          "language": "sql",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/sql",
        "title": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TABLE",
            "data": "col_name\tdata_type\tcomment\ncountry\tstring\tnull\ndescription\tstring\tnull\ndesignation\tstring\tnull\npoints\tstring\tnull\nprice\tbigint\tnull\nprovince\tstring\tnull\nregion_1\tstring\tnull\nregion_2\tstring\tnull\ntaster_name\tstring\tnull\ntaster_twitter_handle\tstring\tnull\ntitle\tstring\tnull\nvariety\tstring\tnull\nwinery\tstring\tnull\n"
          },
          {
            "type": "TEXT",
            "data": ""
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1571412491402_-428181052",
      "id": "20191018-152811_1597872720",
      "dateCreated": "2019-10-18 15:28:11.402",
      "dateStarted": "2019-10-19 01:12:48.773",
      "dateFinished": "2019-10-19 01:12:48.898",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "title": "Simplify finding Missing Values",
      "text": "%spark\ndef missingValues(df: DataFrame) \u003d {\n    df.schema.map {\n        case StructField(name: String, _: StringType, _, _) \u003d\u003e\n            // will do isNull orEmpty check here - and count as missing values\n            (name, df.where(col(name).isNull.or(col(name).equalTo(\"\"))).count())\n        case StructField(name: String, _, _, _) \u003d\u003e\n            (name, df.where(col(name).isNull).count)\n    }.toDF(\"name\", \"missing\")\n}",
      "user": "anonymous",
      "dateUpdated": "2019-10-19 01:12:48.972",
      "config": {
        "colWidth": 6.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/scala",
        "title": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "missingValues: (df: org.apache.spark.sql.DataFrame)org.apache.spark.sql.DataFrame\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1571412639636_2023183746",
      "id": "20191018-153039_94775573",
      "dateCreated": "2019-10-18 15:30:39.637",
      "dateStarted": "2019-10-19 01:12:49.035",
      "dateFinished": "2019-10-19 01:12:50.145",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "title": "Compute the Missing Values",
      "text": "%spark\nwineReviewsJsonNotInferred.persist\nval missingData \u003d missingValues(wineReviewsJsonNotInferred)\nmissingData.createOrReplaceTempView(\"missing\")",
      "user": "anonymous",
      "dateUpdated": "2019-10-19 01:12:50.171",
      "config": {
        "colWidth": 6.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/scala",
        "title": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "missingData: org.apache.spark.sql.DataFrame \u003d [name: string, missing: bigint]\n"
          }
        ]
      },
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            "http://2cd1b9b392ef:4040/jobs/job?id\u003d65",
            "http://2cd1b9b392ef:4040/jobs/job?id\u003d66",
            "http://2cd1b9b392ef:4040/jobs/job?id\u003d67",
            "http://2cd1b9b392ef:4040/jobs/job?id\u003d68",
            "http://2cd1b9b392ef:4040/jobs/job?id\u003d69",
            "http://2cd1b9b392ef:4040/jobs/job?id\u003d70",
            "http://2cd1b9b392ef:4040/jobs/job?id\u003d71",
            "http://2cd1b9b392ef:4040/jobs/job?id\u003d72",
            "http://2cd1b9b392ef:4040/jobs/job?id\u003d73",
            "http://2cd1b9b392ef:4040/jobs/job?id\u003d74",
            "http://2cd1b9b392ef:4040/jobs/job?id\u003d75",
            "http://2cd1b9b392ef:4040/jobs/job?id\u003d76",
            "http://2cd1b9b392ef:4040/jobs/job?id\u003d77"
          ],
          "interpreterSettingId": "spark"
        }
      },
      "apps": [],
      "jobName": "paragraph_1571412846886_942517976",
      "id": "20191018-153406_1460369176",
      "dateCreated": "2019-10-18 15:34:06.886",
      "dateStarted": "2019-10-19 01:12:50.291",
      "dateFinished": "2019-10-19 01:12:57.347",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "title": "Explore the Missing Values",
      "text": "%sql\nselect * from missing ORDER BY missing ASC",
      "user": "anonymous",
      "dateUpdated": "2019-10-19 01:12:57.423",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {
          "0": {
            "graph": {
              "mode": "table",
              "height": 300.0,
              "optionOpen": false,
              "setting": {
                "table": {
                  "tableGridState": {
                    "columns": [
                      {
                        "name": "name",
                        "visible": true,
                        "width": "*",
                        "sort": {},
                        "filters": [
                          {}
                        ],
                        "pinned": ""
                      },
                      {
                        "name": "missing",
                        "visible": true,
                        "width": "*",
                        "sort": {},
                        "filters": [
                          {}
                        ],
                        "pinned": ""
                      }
                    ],
                    "scrollFocus": {},
                    "selection": [],
                    "grouping": {
                      "grouping": [],
                      "aggregations": [],
                      "rowExpandedStates": {}
                    },
                    "treeView": {},
                    "pagination": {
                      "paginationCurrentPage": 1.0,
                      "paginationPageSize": 250.0
                    }
                  },
                  "tableColumnTypeState": {
                    "updated": false,
                    "names": {
                      "name": "string",
                      "missing": "string"
                    }
                  },
                  "updated": false,
                  "initialized": false,
                  "tableOptionSpecHash": "[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]",
                  "tableOptionValue": {
                    "useFilter": false,
                    "showPagination": false,
                    "showAggregationFooter": false
                  }
                }
              },
              "commonSetting": {}
            },
            "helium": {}
          }
        },
        "editorSetting": {
          "language": "sql",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/sql",
        "title": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TABLE",
            "data": "name\tmissing\npoints\t0\nwinery\t0\ntitle\t0\ndescription\t0\nvariety\t1\nprovince\t63\ncountry\t63\nprice\t8996\nregion_1\t21247\ntaster_name\t26244\ntaster_twitter_handle\t31213\ndesignation\t37465\nregion_2\t79460\n"
          },
          {
            "type": "TEXT",
            "data": ""
          }
        ]
      },
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            "http://2cd1b9b392ef:4040/jobs/job?id\u003d78"
          ],
          "interpreterSettingId": "spark"
        }
      },
      "apps": [],
      "jobName": "paragraph_1571412879254_818671906",
      "id": "20191018-153439_369719891",
      "dateCreated": "2019-10-18 15:34:39.254",
      "dateStarted": "2019-10-19 01:12:57.572",
      "dateFinished": "2019-10-19 01:12:58.437",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "title": "Simplify finding Distinct Values",
      "text": "%spark\ndef distinctColumnValues(df: DataFrame): DataFrame \u003d {\n    df.schema.map { r \u003d\u003e\n      (r.name, df.where(col(r.name).isNotNull)\n        .select(col(r.name))\n        .distinct()\n        .count())\n    }.toDF(\"name\", \"distinct\")\n}",
      "user": "anonymous",
      "dateUpdated": "2019-10-19 01:12:58.465",
      "config": {
        "colWidth": 6.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/scala",
        "title": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "distinctColumnValues: (df: org.apache.spark.sql.DataFrame)org.apache.spark.sql.DataFrame\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1571414328063_-1454550239",
      "id": "20191018-155848_1698724816",
      "dateCreated": "2019-10-18 15:58:48.063",
      "dateStarted": "2019-10-19 01:12:58.633",
      "dateFinished": "2019-10-19 01:12:59.735",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "title": "Compute the Distinct Values",
      "text": "%spark\nval distinctValues \u003d distinctColumnValues(wineReviewsJsonNotInferred)\ndistinctValues.createOrReplaceTempView(\"distinct\")",
      "user": "anonymous",
      "dateUpdated": "2019-10-19 01:12:59.830",
      "config": {
        "colWidth": 6.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/scala",
        "title": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "distinctValues: org.apache.spark.sql.DataFrame \u003d [name: string, distinct: bigint]\n"
          }
        ]
      },
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            "http://2cd1b9b392ef:4040/jobs/job?id\u003d79",
            "http://2cd1b9b392ef:4040/jobs/job?id\u003d80",
            "http://2cd1b9b392ef:4040/jobs/job?id\u003d81",
            "http://2cd1b9b392ef:4040/jobs/job?id\u003d82",
            "http://2cd1b9b392ef:4040/jobs/job?id\u003d83",
            "http://2cd1b9b392ef:4040/jobs/job?id\u003d84",
            "http://2cd1b9b392ef:4040/jobs/job?id\u003d85",
            "http://2cd1b9b392ef:4040/jobs/job?id\u003d86",
            "http://2cd1b9b392ef:4040/jobs/job?id\u003d87",
            "http://2cd1b9b392ef:4040/jobs/job?id\u003d88",
            "http://2cd1b9b392ef:4040/jobs/job?id\u003d89",
            "http://2cd1b9b392ef:4040/jobs/job?id\u003d90",
            "http://2cd1b9b392ef:4040/jobs/job?id\u003d91"
          ],
          "interpreterSettingId": "spark"
        }
      },
      "apps": [],
      "jobName": "paragraph_1571414479108_1350495477",
      "id": "20191018-160119_1503275317",
      "dateCreated": "2019-10-18 16:01:19.108",
      "dateStarted": "2019-10-19 01:12:59.898",
      "dateFinished": "2019-10-19 01:13:49.550",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "title": "Explore the Distinct Values",
      "text": "%sql\nselect * from distinct order by distinct ASC",
      "user": "anonymous",
      "dateUpdated": "2019-10-19 01:13:49.626",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {
          "0": {
            "graph": {
              "mode": "table",
              "height": 300.0,
              "optionOpen": false,
              "setting": {
                "table": {
                  "tableGridState": {
                    "columns": [
                      {
                        "name": "name",
                        "visible": true,
                        "width": "*",
                        "sort": {},
                        "filters": [
                          {}
                        ],
                        "pinned": ""
                      },
                      {
                        "name": "distinct",
                        "visible": true,
                        "width": "*",
                        "sort": {},
                        "filters": [
                          {}
                        ],
                        "pinned": ""
                      }
                    ],
                    "scrollFocus": {},
                    "selection": [],
                    "grouping": {
                      "grouping": [],
                      "aggregations": [],
                      "rowExpandedStates": {}
                    },
                    "treeView": {},
                    "pagination": {
                      "paginationCurrentPage": 1.0,
                      "paginationPageSize": 250.0
                    }
                  },
                  "tableColumnTypeState": {
                    "names": {
                      "name": "string",
                      "distinct": "string"
                    },
                    "updated": false
                  },
                  "tableOptionSpecHash": "[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]",
                  "tableOptionValue": {
                    "useFilter": false,
                    "showPagination": false,
                    "showAggregationFooter": false
                  },
                  "updated": false,
                  "initialized": false
                }
              },
              "commonSetting": {}
            }
          }
        },
        "editorSetting": {
          "language": "sql",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/sql",
        "title": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TABLE",
            "data": "name\tdistinct\ntaster_twitter_handle\t15\nregion_2\t17\ntaster_name\t19\npoints\t21\ncountry\t43\nprice\t390\nprovince\t425\nvariety\t707\nregion_1\t1229\nwinery\t16757\ndesignation\t37979\ntitle\t118840\ndescription\t119955\n"
          },
          {
            "type": "TEXT",
            "data": ""
          }
        ]
      },
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            "http://2cd1b9b392ef:4040/jobs/job?id\u003d92"
          ],
          "interpreterSettingId": "spark"
        }
      },
      "apps": [],
      "jobName": "paragraph_1571414572640_386106004",
      "id": "20191018-160252_1693927589",
      "dateCreated": "2019-10-18 16:02:52.640",
      "dateStarted": "2019-10-19 01:13:49.771",
      "dateFinished": "2019-10-19 01:13:50.065",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "title": "Capture Column Statistics",
      "text": "%spark\ndef columnStats(df: DataFrame) \u003d {\n    df.schema.map { r \u003d\u003e\n     val colStats \u003d df.select(col(r.name)).where(col(r.name).isNotNull).describe()\n     colStats.show()\n    }\n}",
      "user": "anonymous",
      "dateUpdated": "2019-10-19 01:13:50.155",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/scala",
        "title": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "columnStats: (df: org.apache.spark.sql.DataFrame)Seq[Unit]\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1571425637280_-374975990",
      "id": "20191018-190717_891977925",
      "dateCreated": "2019-10-18 19:07:17.280",
      "dateStarted": "2019-10-19 01:13:50.275",
      "dateFinished": "2019-10-19 01:13:50.934",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "title": "Iterate and Show all Relevant Stats",
      "text": "%spark\ncolumnStats(wineReviewsJsonNotInferred)",
      "user": "anonymous",
      "dateUpdated": "2019-10-19 01:13:50.968",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/scala",
        "title": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+-------+---------+\n|summary|  country|\n+-------+---------+\n|  count|   129908|\n|   mean|     null|\n| stddev|     null|\n|    min|Argentina|\n|    max|  Uruguay|\n+-------+---------+\n\n+-------+--------------------+\n|summary|         description|\n+-------+--------------------+\n|  count|              129971|\n|   mean|                null|\n| stddev|                null|\n|    min|\"Chremisa,\" the a...|\n|    max|“Wow” is the firs...|\n+-------+--------------------+\n\n+-------+--------------------+\n|summary|         designation|\n+-------+--------------------+\n|  count|               92506|\n|   mean|  1494.4644378698224|\n| stddev|    7115.55431803001|\n|    min|#19 Phantom Limb ...|\n|    max|                 “P”|\n+-------+--------------------+\n\n+-------+------------------+\n|summary|            points|\n+-------+------------------+\n|  count|            129971|\n|   mean| 88.44713820775404|\n| stddev|3.0397302029160067|\n|    min|               100|\n|    max|                99|\n+-------+------------------+\n\n+-------+------------------+\n|summary|             price|\n+-------+------------------+\n|  count|            120975|\n|   mean|35.363389129985535|\n| stddev|41.022217668087315|\n|    min|                 4|\n|    max|              3300|\n+-------+------------------+\n\n+-------+--------+\n|summary|province|\n+-------+--------+\n|  count|  129908|\n|   mean|    null|\n| stddev|    null|\n|    min|  Achaia|\n|    max|    Župa|\n+-------+--------+\n\n+-------+------------+\n|summary|    region_1|\n+-------+------------+\n|  count|      108724|\n|   mean|        null|\n| stddev|        null|\n|    min|     Abruzzo|\n|    max|Zonda Valley|\n+-------+------------+\n\n+-------+-----------------+\n|summary|         region_2|\n+-------+-----------------+\n|  count|            50511|\n|   mean|             null|\n| stddev|             null|\n|    min| California Other|\n|    max|Willamette Valley|\n+-------+-----------------+\n\n+-------+------------------+\n|summary|       taster_name|\n+-------+------------------+\n|  count|            103727|\n|   mean|              null|\n| stddev|              null|\n|    min|Alexander Peartree|\n|    max|    Virginie Boone|\n+-------+------------------+\n\n+-------+---------------------+\n|summary|taster_twitter_handle|\n+-------+---------------------+\n|  count|                98758|\n|   mean|                 null|\n| stddev|                 null|\n|    min|          @AnneInVino|\n|    max|       @worldwineguys|\n+-------+---------------------+\n\n+-------+--------------------+\n|summary|               title|\n+-------+--------------------+\n|  count|              129971|\n|   mean|                null|\n| stddev|                null|\n|    min|1+1\u003d3 2008 Rosé C...|\n|    max|Štoka 2011 Izbran...|\n+-------+--------------------+\n\n+-------+--------+\n|summary| variety|\n+-------+--------+\n|  count|  129970|\n|   mean|    null|\n| stddev|    null|\n|    min|Abouriou|\n|    max| Žilavka|\n+-------+--------+\n\n+-------+--------+\n|summary|  winery|\n+-------+--------+\n|  count|  129971|\n|   mean|Infinity|\n| stddev|     NaN|\n|    min|   1+1\u003d3|\n|    max|   Štoka|\n+-------+--------+\n\nres46: Seq[Unit] \u003d List((), (), (), (), (), (), (), (), (), (), (), (), ())\n"
          }
        ]
      },
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            "http://2cd1b9b392ef:4040/jobs/job?id\u003d93",
            "http://2cd1b9b392ef:4040/jobs/job?id\u003d94",
            "http://2cd1b9b392ef:4040/jobs/job?id\u003d95",
            "http://2cd1b9b392ef:4040/jobs/job?id\u003d96",
            "http://2cd1b9b392ef:4040/jobs/job?id\u003d97",
            "http://2cd1b9b392ef:4040/jobs/job?id\u003d98",
            "http://2cd1b9b392ef:4040/jobs/job?id\u003d99",
            "http://2cd1b9b392ef:4040/jobs/job?id\u003d100",
            "http://2cd1b9b392ef:4040/jobs/job?id\u003d101",
            "http://2cd1b9b392ef:4040/jobs/job?id\u003d102",
            "http://2cd1b9b392ef:4040/jobs/job?id\u003d103",
            "http://2cd1b9b392ef:4040/jobs/job?id\u003d104",
            "http://2cd1b9b392ef:4040/jobs/job?id\u003d105"
          ],
          "interpreterSettingId": "spark"
        }
      },
      "apps": [],
      "jobName": "paragraph_1571425655807_-686676027",
      "id": "20191018-190735_1988973875",
      "dateCreated": "2019-10-18 19:07:35.807",
      "dateStarted": "2019-10-19 01:13:51.158",
      "dateFinished": "2019-10-19 01:13:58.764",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "title": "Identify issues with Column Types",
      "text": "%spark\ncolumnStats(wineReviewsJsonNotInferred.select(col(\"points\")))",
      "user": "anonymous",
      "dateUpdated": "2019-10-19 01:13:58.820",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/scala",
        "title": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+-------+------------------+\n|summary|            points|\n+-------+------------------+\n|  count|            129971|\n|   mean| 88.44713820775404|\n| stddev|3.0397302029160067|\n|    min|               100|\n|    max|                99|\n+-------+------------------+\n\nres47: Seq[Unit] \u003d List(())\n"
          }
        ]
      },
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            "http://2cd1b9b392ef:4040/jobs/job?id\u003d106"
          ],
          "interpreterSettingId": "spark"
        }
      },
      "apps": [],
      "jobName": "paragraph_1571425674101_-49043204",
      "id": "20191018-190754_1010942366",
      "dateCreated": "2019-10-18 19:07:54.101",
      "dateStarted": "2019-10-19 01:13:58.892",
      "dateFinished": "2019-10-19 01:13:59.712",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "title": "Generate Column Aggregations",
      "text": "%spark\ndef calculateColumnAggregates(df: DataFrame): Unit \u003d {\n  df.schema.map { r \u003d\u003e\n    val name \u003d r.name\n    val colData \u003d df.select(col(name)).where(col(name).isNotNull)\n    colData.agg(\n        lit(name) as \"colname\",\n        count(name) as \"count\",\n        min(name) as \"min\",\n        avg(name) as \"avg\",\n        stddev_pop(name) as \"sd_pop\",\n        stddev_samp(name) as \"sd_sample\",\n        max(name) as \"max\"\n    ).show(false)\n  }\n}",
      "user": "anonymous",
      "dateUpdated": "2019-10-19 01:13:59.798",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/scala",
        "title": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "calculateColumnAggregates: (df: org.apache.spark.sql.DataFrame)Unit\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1571426645137_1315706586",
      "id": "20191018-192405_264401894",
      "dateCreated": "2019-10-18 19:24:05.137",
      "dateStarted": "2019-10-19 01:13:59.869",
      "dateFinished": "2019-10-19 01:14:00.592",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "title": "More Column Aggregations",
      "text": "%spark\ncalculateColumnAggregates(wineReviewsJsonNotInferred)",
      "user": "anonymous",
      "dateUpdated": "2019-10-19 01:14:00.675",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/scala",
        "title": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+-------+------+---------+----+------+---------+-------+\n|colname|count |min      |avg |sd_pop|sd_sample|max    |\n+-------+------+---------+----+------+---------+-------+\n|country|129908|Argentina|null|null  |null     |Uruguay|\n+-------+------+---------+----+------+---------+-------+\n\n+-----------+------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----+------+---------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+\n|colname    |count |min                                                                                                                                                                                                   |avg |sd_pop|sd_sample|max                                                                                                                                                                                                                                                                                                                                               |\n+-----------+------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----+------+---------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+\n|description|129971|\"Chremisa,\" the ancient name of Krems, is commemorated in this wine that comes from Krems vineyards. It has tight, tangy apple-driven acidity, with a bright, light, citrusy character. Not for aging.|null|null  |null     |“Wow” is the first word that comes to mind when tasting this superconcentrated and immensely fruity wine. It practically overwhelms the nose and the palate with ripe, jammy boysenberry and blackberry, sprinkled with licorice and black-pepper nuances that add attractive complexity. It\u0027s a big wine all the way, but not extreme in alcohol.|\n+-----------+------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----+------+---------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+\n\n+-----------+-----+---------------------------------+------------------+-----------------+----------------+---+\n|colname    |count|min                              |avg               |sd_pop           |sd_sample       |max|\n+-----------+-----+---------------------------------+------------------+-----------------+----------------+---+\n|designation|92506|#19 Phantom Limb Belmont Vineyard|1494.4644378698224|7094.471147782904|7115.55431803001|“P”|\n+-----------+-----+---------------------------------+------------------+-----------------+----------------+---+\n\n+-------+------+---+-----------------+------------------+------------------+---+\n|colname|count |min|avg              |sd_pop            |sd_sample         |max|\n+-------+------+---+-----------------+------------------+------------------+---+\n|points |129971|100|88.44713820775404|3.0397185090148677|3.0397302029160067|99 |\n+-------+------+---+-----------------+------------------+------------------+---+\n\n+-------+------+---+------------------+-----------------+------------------+----+\n|colname|count |min|avg               |sd_pop           |sd_sample         |max |\n+-------+------+---+------------------+-----------------+------------------+----+\n|price  |120975|4  |35.363389129985535|41.02204811941014|41.022217668087315|3300|\n+-------+------+---+------------------+-----------------+------------------+----+\n\n+--------+------+------+----+------+---------+----+\n|colname |count |min   |avg |sd_pop|sd_sample|max |\n+--------+------+------+----+------+---------+----+\n|province|129908|Achaia|null|null  |null     |Župa|\n+--------+------+------+----+------+---------+----+\n\n+--------+------+-------+----+------+---------+------------+\n|colname |count |min    |avg |sd_pop|sd_sample|max         |\n+--------+------+-------+----+------+---------+------------+\n|region_1|108724|Abruzzo|null|null  |null     |Zonda Valley|\n+--------+------+-------+----+------+---------+------------+\n\n+--------+-----+----------------+----+------+---------+-----------------+\n|colname |count|min             |avg |sd_pop|sd_sample|max              |\n+--------+-----+----------------+----+------+---------+-----------------+\n|region_2|50511|California Other|null|null  |null     |Willamette Valley|\n+--------+-----+----------------+----+------+---------+-----------------+\n\n+-----------+------+------------------+----+------+---------+--------------+\n|colname    |count |min               |avg |sd_pop|sd_sample|max           |\n+-----------+------+------------------+----+------+---------+--------------+\n|taster_name|103727|Alexander Peartree|null|null  |null     |Virginie Boone|\n+-----------+------+------------------+----+------+---------+--------------+\n\n+---------------------+-----+-----------+----+------+---------+--------------+\n|colname              |count|min        |avg |sd_pop|sd_sample|max           |\n+---------------------+-----+-----------+----+------+---------+--------------+\n|taster_twitter_handle|98758|@AnneInVino|null|null  |null     |@worldwineguys|\n+---------------------+-----+-----------+----+------+---------+--------------+\n\n+-------+------+--------------------------------------------+----+------+---------+-------------------------------+\n|colname|count |min                                         |avg |sd_pop|sd_sample|max                            |\n+-------+------+--------------------------------------------+----+------+---------+-------------------------------+\n|title  |129971|1+1\u003d3 2008 Rosé Cabernet Sauvignon (Penedès)|null|null  |null     |Štoka 2011 Izbrani Teran (Kras)|\n+-------+------+--------------------------------------------+----+------+---------+-------------------------------+\n\n+-------+------+--------+----+------+---------+-------+\n|colname|count |min     |avg |sd_pop|sd_sample|max    |\n+-------+------+--------+----+------+---------+-------+\n|variety|129970|Abouriou|null|null  |null     |Žilavka|\n+-------+------+--------+----+------+---------+-------+\n\n+-------+------+-----+--------+------+---------+-----+\n|colname|count |min  |avg     |sd_pop|sd_sample|max  |\n+-------+------+-----+--------+------+---------+-----+\n|winery |129971|1+1\u003d3|Infinity|NaN   |NaN      |Štoka|\n+-------+------+-----+--------+------+---------+-----+\n\n"
          }
        ]
      },
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            "http://2cd1b9b392ef:4040/jobs/job?id\u003d107",
            "http://2cd1b9b392ef:4040/jobs/job?id\u003d108",
            "http://2cd1b9b392ef:4040/jobs/job?id\u003d109",
            "http://2cd1b9b392ef:4040/jobs/job?id\u003d110",
            "http://2cd1b9b392ef:4040/jobs/job?id\u003d111",
            "http://2cd1b9b392ef:4040/jobs/job?id\u003d112",
            "http://2cd1b9b392ef:4040/jobs/job?id\u003d113",
            "http://2cd1b9b392ef:4040/jobs/job?id\u003d114",
            "http://2cd1b9b392ef:4040/jobs/job?id\u003d115",
            "http://2cd1b9b392ef:4040/jobs/job?id\u003d116",
            "http://2cd1b9b392ef:4040/jobs/job?id\u003d117",
            "http://2cd1b9b392ef:4040/jobs/job?id\u003d118",
            "http://2cd1b9b392ef:4040/jobs/job?id\u003d119"
          ],
          "interpreterSettingId": "spark"
        }
      },
      "apps": [],
      "jobName": "paragraph_1571426733340_1916419264",
      "id": "20191018-192533_895930930",
      "dateCreated": "2019-10-18 19:25:33.340",
      "dateStarted": "2019-10-19 01:14:00.836",
      "dateFinished": "2019-10-19 01:14:08.828",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%md\n## Now Let us Move to Part 2\nhttp://localhost:8080/#/notebook/2EQFEJF47",
      "user": "anonymous",
      "dateUpdated": "2019-10-19 01:14:08.887",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ch2\u003eNow Let us Move to Part 2\u003c/h2\u003e\n\u003cp\u003e\u003ca href\u003d\"http://localhost:8080/#/notebook/2EQFEJF47\"\u003ehttp://localhost:8080/#/notebook/2EQFEJF47\u003c/a\u003e\u003c/p\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1571426848129_591654027",
      "id": "20191018-192728_89896051",
      "dateCreated": "2019-10-18 19:27:28.129",
      "dateStarted": "2019-10-19 01:14:09.025",
      "dateFinished": "2019-10-19 01:14:09.058",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%md\n",
      "user": "anonymous",
      "dateUpdated": "2019-10-19 01:14:08.888",
      "config": {},
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "jobName": "paragraph_1571447648887_-40794103",
      "id": "20191019-011408_1770970270",
      "dateCreated": "2019-10-19 01:14:08.887",
      "status": "READY",
      "progressUpdateIntervalMs": 500
    }
  ],
  "name": "/SVCC/1-SparkIntro",
  "id": "2EPW233GF",
  "noteParams": {},
  "noteForms": {},
  "angularObjects": {
    "md:shared_process": [],
    "spark:shared_process": []
  },
  "config": {
    "isZeppelinNotebookCronEnable": false
  },
  "info": {}
}